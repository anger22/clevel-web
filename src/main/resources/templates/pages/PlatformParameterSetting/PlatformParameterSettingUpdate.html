<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <title>表单组合</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../../layuiadmin/style/admin.css" media="all">
</head>
<body>

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-header">编辑</div>
        <div class="layui-card-body" style="padding: 15px;">
            <form class="layui-form" action="" lay-filter="component-form-group" id="form">
                <input type="hidden" name="id" th:value="${platformParameterSetting.id}">
                <div style="display: inline-flex">
                    <div class="layui-form-item" style="margin-left: 32px;margin-right: 32px">
                        <label class="layui-form-label" style="width: 84px"><span style="color: red">*</span>请输入app端启用页视频</label>
                        <div class="layui-upload">
                            <button type="button" class="layui-btn" id="test1">上传视频</button>
                            <div class="layui-upload-list">
                                <video class="layui-upload-img" id="demo1" controls="controls"
                                     th:src="${platformParameterSetting.launchPage}"
                                     style="width: 300px;height: 300px"/>
                                <input type="hidden" name="launchPage" id="images"
                                       th:value="${platformParameterSetting.launchPage}">
                            </div>
                            <div style="height: 20px;"></div>
                            <div class="layui-progress" lay-showpercent="true" lay-filter="js_upload_progress1"
                                 style="margin: 10px;">
                                <div class="layui-progress-bar layui-bg-red" lay-percent="0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red">*</span>请上传login视频</label>
                        <div class="layui-upload">
                            <button type="button" class="layui-btn" id="test2">上传视频</button>
                            <div class="layui-upload-list">
                                <video class="layui-upload-img" id="demo2" controls="controls"
                                     th:src="${platformParameterSetting.loginImage}"
                                     style="width: 300px;height: 300px"/>
                                <input type="hidden" name="loginImage" id="images2"
                                       th:value="${platformParameterSetting.loginImage}">
                            </div>
                            <div style="height: 20px;"></div>
                            <div class="layui-progress" lay-showpercent="true" lay-filter="js_upload_progress2"
                                 style="margin: 10px;">
                                <div class="layui-progress-bar layui-bg-red" lay-percent="0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>安卓app版本号</label>
                    <div class="layui-input-block">
                        <input type="text" name="version" id="version" lay-verify="required|version" autocomplete="off"
                               placeholder="安卓app版本号"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.version}"
                        >
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>苹果app版本号</label>
                    <div class="layui-input-block">
                        <input type="text" name="appleVersion" id="appleVersion" lay-verify="required|appleVersion" autocomplete="off"
                               placeholder="苹果app版本号"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.appleVersion}"
                        >
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>app更新内容</label>
                    <div class="layui-input-block">
                        <input type="text" name="description" id="description" lay-verify="required|description"
                               autocomplete="off"
                               placeholder="app更新内容"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.description}"
                        >
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>上传ios包</label>
                    <div class="layui-input-block">
                        <input type="text" name="applePackageDownloadUrl"
                               lay-verify="required|applePackageDownloadUrl" autocomplete="off"
                               placeholder="上传ios包"
                               id="demo3"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.applePackageDownloadUrl}" style="width: 91%;display: inline;"
                        >
                        <button type="button" class="layui-btn" id="test3">上传ios包</button>
                        <div style="height: 20px;"></div>
                        <div class="layui-progress" lay-showpercent="true" lay-filter="js_upload_progress3"
                             style="margin: 10px;">
                            <div class="layui-progress-bar layui-bg-red" lay-percent="0%"></div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>上传android包</label>
                    <div class="layui-input-block">
                        <input type="text" name="androidPackageDownloadUrl"
                               lay-verify="required|androidPackageDownloadUrl" autocomplete="off"
                               placeholder="上传android包"
                               id="demo4"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.androidPackageDownloadUrl}" style="width: 91%;display: inline;"
                        >
                        <button type="button" class="layui-btn" id="test4">上传android包</button>
                        <div style="height: 20px;"></div>
                        <div class="layui-progress" lay-showpercent="true" lay-filter="js_upload_progress4"
                             style="margin: 10px;">
                            <div class="layui-progress-bar layui-bg-red" lay-percent="0%"></div>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入用户收到的礼物平台抽成比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="drawInProportion" id="drawInProportion"
                               lay-verify="required|drawInProportion" autocomplete="off"
                               placeholder="请输入用户收到的礼物平台抽成比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.drawInProportion}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入每元对应金钻数</label>
                    <div class="layui-input-block">
                        <input type="text" name="goldDiamondsPerYuan" id="goldDiamondsPerYuan"
                               lay-verify="required|goldDiamondsPerYuan" autocomplete="off"
                               placeholder="请输入每元对应金钻数"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.goldDiamondsPerYuan}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入客服电话</label>
                    <div class="layui-input-block">
                        <input type="text" name="telephone" id="telephone" lay-verify="required|telephone"
                               autocomplete="off"
                               placeholder="请输入客服电话"
                               class="layui-input" required="required" th:value="${platformParameterSetting.telephone}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入设置一级分销返佣比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="proportionOfReturnedServants" id="proportionOfReturnedServants"
                               lay-verify="required|proportionOfReturnedServants" autocomplete="off"
                               placeholder="请输入设置一级分销返佣比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.proportionOfReturnedServants}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入设置二级分销返佣比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="proportionOfReturnedServantsTwo" id="proportionOfReturnedServantsTwo"
                               lay-verify="required|proportionOfReturnedServantsTwo" autocomplete="off"
                               placeholder="请输入设置二级分销返佣比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.proportionOfReturnedServantsTwo}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span
                            style="color: red">*</span>请输入设置通过他人分享注册的用户，自身提现比例提高XX%</label>
                    <div class="layui-input-block">
                        <input type="text" name="selfWithdrawal" id="selfWithdrawal"
                               lay-verify="required|selfWithdrawal" autocomplete="off"
                               placeholder="请输入设置通过他人分享注册的用户，自身提现比例提高XX%"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.selfWithdrawal}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入发送礼物获得对应钻石价值比例的经验值数量</label>
                    <div class="layui-input-block">
                        <input type="text" name="giftExperienceRatio" id="giftExperienceRatio"
                               lay-verify="required|giftExperienceRatio" autocomplete="off"
                               placeholder="请输入发送礼物获得对应钻石价值比例的经验值数量"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.giftExperienceRatio}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入发起赴约获得对应钻石价值比例的经验值数量</label>
                    <div class="layui-input-block">
                        <input type="text" name="proportionOfExperience" id="proportionOfExperience"
                               lay-verify="required|proportionOfExperience" autocomplete="off"
                               placeholder="请输入发起赴约获得对应钻石价值比例的经验值数量"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.proportionOfExperience}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入设置小喇叭单价</label>
                    <div class="layui-input-block">
                        <input type="text" name="unitPriceOfLoudspeaker" id="unitPriceOfLoudspeaker"
                               lay-verify="required|unitPriceOfLoudspeaker" autocomplete="off"
                               placeholder="请输入设置小喇叭单价"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.unitPriceOfLoudspeaker}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入银钻兑换金钻手续费比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="exchangeRateOfGoldDiamond" id="exchangeRateOfGoldDiamond"
                               lay-verify="required|exchangeRateOfGoldDiamond" autocomplete="off"
                               placeholder="设置银钻兑换金钻手续费比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.exchangeRateOfGoldDiamond}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入银钻兑换黑钻手续费比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="exchangeRateForBlackDiamonds" id="exchangeRateForBlackDiamonds"
                               lay-verify="required|exchangeRateForBlackDiamonds" autocomplete="off"
                               placeholder="设置银钻兑换黑钻手续费比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.exchangeRateForBlackDiamonds}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入黑钻兑换余额比例</label>
                    <div class="layui-input-block">
                        <input type="text" name="proportionOfExchangeBalance" id="proportionOfExchangeBalance"
                               lay-verify="required|proportionOfExchangeBalance" autocomplete="off"
                               placeholder="设置黑钻兑换余额比例"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.proportionOfExchangeBalance}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入六个可兑换金钻的选项</label>
                    <div class="layui-input-block">
                        <input type="text" name="sixGoldSize" id="sixGoldSize"
                               lay-verify="required|sixGoldSize" autocomplete="off"
                               placeholder="设置六个可兑换金钻的选项"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.sixGoldSize}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入六个可兑换黑钻的数量</label>
                    <div class="layui-input-block">
                        <input type="text" name="sixBlackSize" id="sixBlackSize"
                               lay-verify="required|sixBlackSize" autocomplete="off"
                               placeholder="设置六个可兑换黑钻的数量"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.sixBlackSize}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>请输入APP端人脸认证相似度</label>
                    <div class="layui-input-block">
                        <input type="text" name="faceSimilarity" id="faceSimilarity"
                               lay-verify="required|faceSimilarity" autocomplete="off"
                               placeholder="请输入APP端人脸认证相似度"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.faceSimilarity}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>会员使用时间（小时）</label>
                    <div class="layui-input-block">
                        <input type="text" name="memberUsageTime" id="memberUsageTime"
                               lay-verify="required|memberUsageTime" autocomplete="off"
                               placeholder="请输入会员使用时间（小时）"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.memberUsageTime}">
                    </div>
                </div>



                <div class="layui-form-item">
                    <label class="layui-form-label"><span style="color: red">*</span>世界之窗发布消息需要的金钻数</label>
                    <div class="layui-input-block">
                        <input type="number" min="0" max="9999999" name="worldSpeakGlod" id="worldSpeakGlod"
                                autocomplete="off"
                               placeholder="请输入金钻数"
                               class="layui-input" required="required"
                               th:value="${platformParameterSetting.worldSpeakGlod}">
                    </div>
                </div>

                <div class="layui-form-item layui-layout-admin">
                    <div class="layui-input-block">
                        <div class="layui-footer" style="left: 0;">
                            <button class="layui-btn" lay-submit="" lay-filter="component-form-demo1">立即提交</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>


<script src="../../../layuiadmin/layui/layui.js"></script>
<script src="../../../layuiadmin/layui/lay/modules/upload1.js"></script>
<script>
    layui.config({
        base: '../../../layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form', 'upload1', 'laydate', 'layedit'], function () {
        var $ = layui.$
            , admin = layui.admin
            , element = layui.element
            , layer = layui.layer
            , laydate = layui.laydate
            , layedit = layui.layedit
            , upload1 = layui.upload1
            , form = layui.form;


        var xhrOnProgress = function (fun) {
            xhrOnProgress.onprogress = fun; //绑定监听
            //使用闭包实现监听绑
            return function () {
                //通过$.ajaxSettings.xhr();获得XMLHttpRequest对象
                var xhr = $.ajaxSettings.xhr();
                //判断监听函数是否为函数
                if (typeof xhrOnProgress.onprogress !== 'function')
                    return xhr;
                //如果有监听函数并且xhr对象支持绑定时就把监听函数绑定上去
                if (xhrOnProgress.onprogress && xhr.upload) {
                    xhr.upload.onprogress = xhrOnProgress.onprogress;
                }
                return xhr;
            }
        }

        element.init();
        /* 监听提交 */
        form.on('submit(component-form-demo1)', function (data) {
            var json = $('#form').serialize();
            json = decodeURIComponent(json, true);
            $.ajaxSettings.headers = {"token": layui.data(layui.setter.tableName)['token']};
            $.ajax({
                url: '/platformParameterSetting/update',
                type: "post",
                data: json,
                async: false,
                success: function (result) {
                    if (result.status == 200) {
                        location.reload();
                    } else {
                        layer.msg(result.message, {
                            offset: '15px'
                            , icon: 2
                            , time: 1000
                        }, function () {
                            location.reload();
                        });
                    }
                },
                error: function (result) {
                    location.reload();
                }
            });
        });
        var uploadInst = upload1.render({
            elem: '#test1'
            , url: '/jiaoyou/file/UploadFile' //改成您自己的上传接口
            , headers: {"token": layui.data(layui.setter.tableName)['token']}
            , xhr: xhrOnProgress
            , progress: function (value) {//上传进度回调 value进度值
                element.progress('js_upload_progress1', value + '%');//设置页面进度条
            }
            ,accept:'video'
            , before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#demo1').attr('src', result); //图片链接（base64）
                });
            }
            , done: function (res) {
                //如果上传失败
                if (res.status != 200) {
                    return layer.msg('上传失败');
                }
                //上传成功
                layer.msg('上传成功');
                $("#images").val(res.data)
            }
            , error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function () {
                    uploadInst.upload();
                });
            }
        });

        var uploadInst2 = upload1.render({
            elem: '#test2'
            , url: '/jiaoyou/file/UploadFile' //改成您自己的上传接口
            , headers: {"token": layui.data(layui.setter.tableName)['token']}
            , xhr: xhrOnProgress
            ,accept:'video'
            , progress: function (value) {//上传进度回调 value进度值
                element.progress('js_upload_progress2', value + '%');//设置页面进度条
            }
            , before: function (obj) {
                //预读本地文件示例，不支持ie8
                obj.preview(function (index, file, result) {
                    $('#demo2').attr('src', result); //图片链接（base64）
                });
            }
            , done: function (res) {
                //如果上传失败
                if (res.status != 200) {
                    return layer.msg('上传失败');
                }
                //上传成功
                layer.msg('上传成功');
                $("#images2").val(res.data)
            }
            , error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function () {
                    uploadInst2.upload();
                });
            }
        });

        var uploadInst3 = upload1.render({
            elem: '#test3'
            , accept: "file"
            , url: '/jiaoyou/file/UploadFile' //改成您自己的上传接口
            , headers: {"token": layui.data(layui.setter.tableName)['token']}
            , xhr: xhrOnProgress
            , progress: function (value) {//上传进度回调 value进度值
                element.progress('js_upload_progress3', value + '%');//设置页面进度条
            }
            , done: function (res) {
                //如果上传失败
                if (res.status != 200) {
                    return layer.msg('上传失败');
                }
                $('#demo3').attr('value', res.data); //图片链接（base64）
                //上传成功
                layer.msg('上传成功');
            }
            , error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function () {
                    uploadInst3.upload();
                });
            }
        });
        var uploadInst4 = upload1.render({
            elem: '#test4'
            , accept: "file"
            ,exts: 'apk'
            , url: '/jiaoyou/file/UploadFile' //改成您自己的上传接口
            , headers: {"token": layui.data(layui.setter.tableName)['token']}
            , xhr: xhrOnProgress
            , progress: function (value) {//上传进度回调 value进度值
                element.progress('js_upload_progress4', value + '%');//设置页面进度条
            }
            , done: function (res) {
                //如果上传失败
                if (res.status != 200) {
                    return layer.msg('上传失败');
                }
                $('#demo4').attr('value', res.data); //图片链接（base64）
                //上传成功
                layer.msg('上传成功');
            }
            , error: function () {
                //演示失败状态，并实现重传
                var demoText = $('#demoText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function () {
                    uploadInst4.upload();
                });
            }
        });
    });
</script>
</body>
</html>

